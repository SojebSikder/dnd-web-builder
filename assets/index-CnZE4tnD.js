(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function e(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=e(o);fetch(o.href,i)}})();const x={order:["header","content"],sections:{header:{id:"header",type:"container",settings:{}},content:{id:"content",type:"rich-text",settings:{heading:"About Us"},blocks:[{id:"b1",type:"text",settings:{text:"We are building a modern block editor."}},{id:"b4",type:"link",settings:{label:"Contact",href:"/contact"}},{id:"b5",type:"button",settings:{label:"Click me"}},{id:"b6",type:"quote",settings:{text:"Hello world, this is quote"}}]}}},f={},b={},g={},m={};function k(s){s.blocks?.forEach(t=>{if(g[t.type]){console.warn(`Block already registered: ${t.type}`);return}g[t.type]=t.renderer,f[t.type]=t}),s.sections?.forEach(t=>{if(m[t.type]){console.warn(`Section already registered: ${t.type}`);return}m[t.type]=t.renderer,b[t.type]=t}),console.log(`Plugin loaded: ${s.name}`)}function u(s){return f[s]}function y(s){return b[s]}function E(){return Object.values(b)}function C(){return Object.values(f)}class B{app;editor;settingsContainer;selected=null;designMode=!0;pageData;constructor(t){this.app=t,this.buildUI(),this.editor.addEventListener("click",e=>{if(!this.designMode)return;const n=e.target;n.closest("a")&&(e.preventDefault(),e.stopPropagation()),n.closest("button")&&(e.preventDefault(),e.stopPropagation())}),this.editor.addEventListener("submit",e=>{this.designMode&&(e.preventDefault(),e.stopPropagation())})}buildUI(){const t=document.createElement("div");t.classList.add("layout");const e=document.createElement("aside");e.id="sidebar";const n=document.createElement("h3");n.textContent="Sections";const o=document.createElement("div");o.id="section-list",o.classList.add("section-list");const i=document.createElement("h3");i.textContent="Blocks";const l=document.createElement("div");l.id="block-list",l.classList.add("section-list");const r=document.createElement("div");r.id="toolbar";const a=document.createElement("button");a.id="delete-btn",a.textContent="Delete Selected";const d=document.createElement("div");d.classList.add("main-content");const p=document.createElement("div");p.id="editor";const h=document.createElement("div");h.id="settings-panel",d.appendChild(p),d.appendChild(h),r.appendChild(a),e.appendChild(r),e.appendChild(n),e.appendChild(o),e.appendChild(i),e.appendChild(l),t.appendChild(e),t.appendChild(d),this.app.appendChild(t),this.editor=p,this.settingsContainer=h,a.addEventListener("click",()=>{this.deleteSelected()})}setDesignMode(t){this.designMode=t,t?this.editor.classList.add("design-mode"):this.editor.classList.remove("design-mode")}load(t){this.pageData=t,this.editor.innerHTML="",this.pageData.order.forEach(e=>{const n=this.pageData.sections[e];n&&this.loadSection(n,this)})}loadSection(t,e){const n=m[t.type];if(!n){console.warn(`No renderer for section: ${t.type}`);return}const o=n(t,e);o.classList.add("editor-section"),o.dataset.sectionId=t.id,o.dataset.sectionType=t.type,this.editor.appendChild(o),o.draggable=!0,this.setupSectionDrag(o),this.editor.addEventListener("dragover",i=>{i.preventDefault();const l=this.editor.querySelector(".dragging");if(!l)return;const r=this.getDragAfterElement(this.editor,i.clientY);r==null?this.editor.appendChild(l):this.editor.insertBefore(l,r)}),this.editor.addEventListener("drop",i=>{i.preventDefault();const l=Array.from(this.editor.children).filter(r=>r.classList.contains("editor-section")).map(r=>r.dataset.sectionId);this.pageData.order=l}),o.addEventListener("click",()=>{this.selected={type:"section",id:t.id};const i=y(t.type);i&&this.showSettings(i,t.settings)})}getDragAfterElement(t,e,n="editor-section"){return[...t.querySelectorAll(`.${n}:not(.dragging)`)].reduce((i,l)=>{const r=l.getBoundingClientRect(),a=e-r.top-r.height/2;return a<0&&a>i.offset?{offset:a,element:l}:i},{offset:Number.NEGATIVE_INFINITY,element:null}).element}renderBlocks({blocks:t}){const e=document.createElement("div");return e.className="editor-blocks",t?.forEach(n=>{const o=g[n.type];if(!o){console.warn(`No block renderer for: ${n.type}`);return}const i=o(n);i.classList.add("editor-block"),i.dataset.blockId=n.id,i.dataset.blockType=n.type,e.appendChild(i),i.addEventListener("click",l=>{l.stopPropagation(),this.selected={type:"block",id:n.id};const r=u(n.type);r&&this.showSettings(r,n.settings)}),i.draggable=!0,this.setupSectionDrag(i),e.addEventListener("dragover",l=>{l.preventDefault();const r=e.querySelector(".dragging");if(!r)return;const a=this.getDragAfterElement(e,l.clientY,"editor-block");a==null?e.appendChild(r):e.insertBefore(r,a)}),e.addEventListener("drop",l=>{l.preventDefault();const r=i.dataset.sectionId,a=this.pageData.sections[r];if(!a)return;const d=Array.from(e.children).filter(p=>p.classList.contains("editor-block")).map(p=>p.dataset.blockId);a.blocks=d.map(p=>a.blocks.find(h=>h.id===p))})}),e}setupSectionDrag(t){t.draggable=!0,t.addEventListener("dragstart",e=>{t.classList.add("dragging"),e.dataTransfer?.setData("text/plain",t.dataset.sectionId)}),t.addEventListener("dragend",()=>{t.classList.remove("dragging")})}showSettings(t,e){this.settingsContainer.innerHTML="";const n=this.renderSettingsPanel(e,t.settingsSchema);this.settingsContainer.appendChild(n)}renderSettingsPanel(t,e){const n=document.createElement("div");return n.className="editor-settings-panel",e&&e.forEach(o=>{const i=document.createElement("div");i.className="editor-settings-field";const l=document.createElement("label");l.textContent=o.label,l.htmlFor=o.key;let r;switch(o.type){case"text":case"number":case"color":r=document.createElement("input"),r.type=o.type,o.type==="number"&&(o.min!==void 0&&(r.min=String(o.min)),o.max!==void 0&&(r.max=String(o.max)),o.step!==void 0&&(r.step=String(o.step))),r.value=t[o.key]??"";break;case"boolean":r=document.createElement("input"),r.type="checkbox",r.checked=!!t[o.key];break;case"select":r=document.createElement("select"),o.options?.forEach(a=>{const d=document.createElement("option");d.value=a,d.textContent=a,t[o.key]===a&&(d.selected=!0),r.appendChild(d)});break}r.addEventListener("input",()=>{let a;o.type==="boolean"?a=r.checked:o.type==="number"?a=Number(r.value):a=r.value,t[o.key]=a,this.refreshSelected()}),r.id=o.key,i.appendChild(l),i.appendChild(r),n.appendChild(i),this.refreshSelected()}),n}refreshSelected(){if(!this.selected)return;const t=(e,n)=>{const o=y(e.type);if(!o)return;const i=o.renderer(e,this);i.classList.add("editor-section"),i.dataset.sectionId=e.id,i.dataset.sectionType=e.type,this.setupSectionDrag(i),i.addEventListener("click",()=>{this.selected={type:"section",id:e.id},this.showSettings(o,e.settings)});const l=i.querySelector(".editor-blocks");e.blocks&&l&&(l.innerHTML="",e.blocks.forEach(r=>{const a=u(r.type);if(!a)return;const d=a.renderer(r);d.classList.add("editor-block"),d.dataset.blockId=r.id,d.dataset.blockType=r.type,this.setupSectionDrag(d),d.addEventListener("click",p=>{p.stopPropagation(),this.selected={type:"block",id:r.id},this.showSettings(a,r.settings)}),l.appendChild(d)})),n.replaceWith(i)};if(this.selected.type==="section"){const e=this.editor.querySelector(`[data-section-id="${this.selected.id}"]`);if(!e)return;const n=this.findSectionById(this.selected.id);if(!n)return;t(n,e)}if(this.selected.type==="block")for(const e of Object.values(this.pageData.sections)){const n=e.blocks?.find(d=>d.id===this.selected.id);if(!n)continue;const o=this.editor.querySelector(`[data-section-id="${e.id}"]`);if(!o)return;const i=o.querySelector(".editor-blocks");if(!i)return;const l=i.querySelector(`[data-block-id="${n.id}"]`);if(!l)return;const r=u(n.type);if(!r)return;const a=r.renderer(n);a.classList.add("editor-block"),a.dataset.blockId=n.id,a.dataset.blockType=n.type,this.setupSectionDrag(a),a.addEventListener("click",d=>{d.stopPropagation(),this.selected={type:"block",id:n.id},this.showSettings(r,n.settings)}),l.replaceWith(a);break}}findSectionById(t){return Object.values(this.pageData.sections).find(e=>e.id===t)}findBlockById(t){for(const e of Object.values(this.pageData.sections)){const n=e.blocks?.find(o=>o.id===t);if(n)return n}}initChooser(){const t=document.getElementById("section-list"),e=document.getElementById("block-list");t.innerHTML="",e.innerHTML="",E().forEach(n=>{const o=this.createPluginItem("section",n.type);t.appendChild(o)}),C().forEach(n=>{const o=this.createPluginItem("block",n.type);e.appendChild(o)}),this.setupDropZones()}createPluginItem(t,e){const n=document.createElement("div");return n.className="plugin-item",n.textContent=e.replace(/-/g," "),n.draggable=!0,n.addEventListener("dragstart",o=>{o.dataTransfer?.setData("type",t),o.dataTransfer?.setData("plugin",e)}),n}setupDropZones(){this.editor.addEventListener("dragover",t=>{t.preventDefault()}),this.editor.addEventListener("drop",t=>{t.preventDefault();const e=t.dataTransfer?.getData("type"),n=t.dataTransfer?.getData("plugin");if(!(!e||!n)){if(e==="section"){this.addSection(n);return}if(e==="block"){const i=t.target.closest("[data-section-id]");if(!i)return;const l=i.dataset.sectionId;this.addBlock(l,n)}}})}addSection(t){const e=y(t);if(!e)return;const n=`section-${Date.now()}`,o={id:n,type:e.type,settings:{},blocks:[]};this.pageData.sections[n]=o,this.pageData.order.push(n);const i=e.renderer(o,this);i.classList.add("editor-section"),i.dataset.sectionId=n,i.dataset.sectionType=e.type,this.editor.appendChild(i),this.selected={type:"section",id:n},this.showSettings(e,o.settings),this.setupSectionDrag(i)}addBlock(t,e){const n=u(e);if(!n)return;const o=this.pageData.sections[t];if(!o)return;const i=`block-${Date.now()}`,l={id:i,type:n.type,settings:{}};o.blocks=o.blocks||[],o.blocks.push(l);const r=n.renderer(l);r.classList.add("editor-block"),r.dataset.blockId=i,r.dataset.blockType=n.type,r.addEventListener("click",p=>{p.stopPropagation(),this.selected={type:"block",id:i},this.showSettings(n,l.settings)}),this.setupSectionDrag(r);const a=this.editor.querySelector(`[data-section-id="${t}"]`);let d=a.querySelector(".editor-blocks");d||(d=this.renderBlocks({blocks:[]}),a.appendChild(d)),d.appendChild(r),this.selected={type:"block",id:i},this.showSettings(n,l.settings)}deleteSection(t){const e=this.editor.querySelector(`[data-section-id="${t}"]`);e&&e.remove(),delete this.pageData.sections[t],this.pageData.order=this.pageData.order.filter(n=>n!==t),this.selected?.type==="section"&&this.selected.id===t&&(this.selected=null,this.settingsContainer.innerHTML="")}deleteBlock(t){for(const e of Object.values(this.pageData.sections)){const n=e.blocks?.findIndex(l=>l.id===t);if(n===void 0||n===-1)continue;e.blocks.splice(n,1);const o=this.editor.querySelector(`[data-section-id="${e.id}"]`);if(!o)return;const i=o.querySelector(`[data-block-id="${t}"]`);i&&i.remove(),this.selected?.type==="block"&&this.selected.id===t&&(this.selected=null,this.settingsContainer.innerHTML="");break}}deleteSelected(){this.selected&&(this.selected.type==="section"?this.deleteSection(this.selected.id):this.selected.type==="block"&&this.deleteBlock(this.selected.id))}}class c{static BaseStyleSchema=[{key:"color",label:"Color",type:"color"},{key:"backgroundColor",label:"Background Color",type:"color"},{key:"height",label:"Height",type:"text"},{key:"width",label:"Width",type:"text"},{key:"paddingTop",label:"Padding Top",type:"text"},{key:"paddingRight",label:"Padding Right",type:"text"},{key:"paddingBottom",label:"Padding Bottom",type:"text"},{key:"paddingLeft",label:"Padding Left",type:"text"},{key:"marginTop",label:"Margin Top",type:"text"},{key:"marginRight",label:"Margin Right",type:"text"},{key:"marginBottom",label:"Margin Bottom",type:"text"},{key:"marginLeft",label:"Margin Left",type:"text"},{key:"borderRadius",label:"Border Radius",type:"text"},{key:"borderWidth",label:"Border Width",type:"text"},{key:"borderColor",label:"Border Color",type:"color"},{key:"display",label:"Display",type:"select",options:["block","flex","inline","inline-block","none"]},{key:"position",label:"Position",type:"select",options:["static","relative","absolute","fixed","sticky"]},{key:"top",label:"Top",type:"text"},{key:"right",label:"Right",type:"text"},{key:"left",label:"Left",type:"text"},{key:"bottom",label:"Bottom",type:"text"},{key:"font",label:"Font",type:"select",options:["none","Arial","Helvetica","Times New Roman"]},{key:"fontSize",label:"Font Size",type:"select",options:["none","12px","14px","16px","18px","20px"]},{key:"fontWeight",label:"Font Weight",type:"select",options:["none","normal","bold","bolder","lighter"]},{key:"fontStyle",label:"Font Style",type:"select",options:["none","normal","italic","oblique"]},{key:"lineHeight",label:"Line Height",type:"select",options:["none","1","1.5","2","2.5"]},{key:"textAlign",label:"Text Align",type:"select",options:["none","left","center","right"]},{key:"textDecoration",label:"Text Decoration",type:"select",options:["none","underline","overline","line-through"]},{key:"textTransform",label:"Text Transform",type:"select",options:["none","uppercase","lowercase","capitalize"]},{key:"letterSpacing",label:"Letter Spacing",type:"text"},{key:"float",label:"Float",type:"select",options:["none","left","right"]}];static applyBaseStyles(t,e){e.color&&(t.style.color=e.color),e.backgroundColor&&(t.style.backgroundColor=e.backgroundColor),e.height&&(t.style.height=`${e.height}`),e.width&&(t.style.width=`${e.width}`),e.paddingTop&&(t.style.paddingTop=`${e.paddingTop}`),e.paddingRight&&(t.style.paddingRight=`${e.paddingRight}`),e.paddingBottom&&(t.style.paddingBottom=`${e.paddingBottom}`),e.paddingLeft&&(t.style.paddingLeft=`${e.paddingLeft}`),e.marginTop&&(t.style.marginTop=`${e.marginTop}`),e.marginRight&&(t.style.marginRight=`${e.marginRight}`),e.marginBottom&&(t.style.marginBottom=`${e.marginBottom}`),e.marginLeft&&(t.style.marginLeft=`${e.marginLeft}`),e.borderRadius&&(t.style.borderRadius=`${e.borderRadius}`),e.borderWidth&&(t.style.borderWidth=`${e.borderWidth}`),e.borderColor&&(t.style.borderColor=e.borderColor),e.display&&(t.style.display=e.display),e.position&&(t.style.position=e.position),e.top&&(t.style.top=e.top),e.right&&(t.style.right=e.right),e.left&&(t.style.left=e.left),e.bottom&&(t.style.bottom=e.bottom),e.font&&(t.style.fontFamily=e.font),e.fontSize&&(t.style.fontSize=e.fontSize),e.fontWeight&&(t.style.fontWeight=e.fontWeight),e.textDecoration&&(t.style.textDecoration=e.textDecoration),e.textTransform&&(t.style.textTransform=e.textTransform),e.letterSpacing&&(t.style.letterSpacing=e.letterSpacing),e.lineHeight&&(t.style.lineHeight=e.lineHeight),e.textAlign&&(t.style.textAlign=e.textAlign)}}const v={name:"Core Blocks",blocks:[{defaultSettings:{text:"Your text here"},settingsSchema:[{key:"text",label:"Text",type:"text"},...c.BaseStyleSchema],type:"text",renderer:s=>{const t=document.createElement("p");return c.applyBaseStyles(t,s.settings),t.textContent=s.settings.text||"Text block",t}},{type:"image",renderer:s=>{const t=document.createElement("img");return t.src=s.settings.src,t.alt=s.settings.alt||"",t.style.maxWidth="40%",t},defaultSettings:{src:"",alt:""}},{type:"link",settingsSchema:[{key:"label",label:"Text",type:"text"},...c.BaseStyleSchema],renderer:s=>{const t=document.createElement("a");return c.applyBaseStyles(t,s.settings),t.textContent=s.settings.label||"Button",t.href=s.settings.href||"#",t.className="link",t},defaultSettings:{label:"Click me",href:"#"}},{type:"button",settingsSchema:[{key:"label",label:"Text",type:"text"},...c.BaseStyleSchema],defaultSettings:{label:"Click me"},renderer:s=>{const t=document.createElement("button");return c.applyBaseStyles(t,s.settings),t.textContent=s.settings.label||"Button",t.className="btn",t}}]},L={name:"Core Sections",sections:[{type:"container",settingsSchema:[{key:"customTitle",label:"Custom Title",type:"text"},...c.BaseStyleSchema],renderer:(s,t)=>{const e=document.createElement("section");if(e.className="container",c.applyBaseStyles(e,s.settings),s.settings.customTitle){const n=document.createElement("h2");n.textContent=s.settings.customTitle,e.appendChild(n)}return e.appendChild(t.renderBlocks({blocks:s.blocks})),e}},{type:"rich-text",settingsSchema:[{key:"heading",label:"Heading",type:"text"},...c.BaseStyleSchema],renderer:(s,t)=>{const e=document.createElement("section");if(e.className="rich-text",c.applyBaseStyles(e,s.settings),s.settings.heading){const n=document.createElement("h2");n.textContent=s.settings.heading,e.appendChild(n)}return e.appendChild(t.renderBlocks({blocks:s.blocks})),e}},{type:"featured-collection",settingsSchema:[{key:"title",label:"Title",type:"text"},{key:"textContent",label:"Description",type:"text"},...c.BaseStyleSchema],renderer:s=>{const t=document.createElement("section");t.className="featured-collection",c.applyBaseStyles(t,s.settings);const e=document.createElement("h2");e.textContent=s.settings.title||"Featured Collection",t.appendChild(e);const n=document.createElement("div");return n.textContent=s.settings.textContent||"ðŸ›’ Product preview (editor only)",n.style.opacity="0.6",t.appendChild(n),t}},{type:"contact-form",settingsSchema:[{key:"heading",label:"Text",type:"text"},{key:"buttonText",label:"Button Text",type:"text"},{key:"namePlaceholder",label:"Name Placeholder",type:"text"},{key:"emailPlaceholder",label:"Email Placeholder",type:"text"},{key:"messagePlaceholder",label:"Message Placeholder",type:"text"},{key:"buttonColor",label:"Button Color",type:"color"},{key:"buttonBackgroundColor",label:"Button Background Color",type:"color"},{key:"buttonBorderColor",label:"Button Border Color",type:"color"},...c.BaseStyleSchema],renderer:s=>{const t=document.createElement("section");t.className="contact-form",c.applyBaseStyles(t,s.settings);const e=document.createElement("h2");e.textContent=s.settings.heading||"Contact Us",t.appendChild(e);const n=document.createElement("form"),o=document.createElement("input");o.type="text",o.placeholder=s.settings.namePlaceholder||"Name",n.appendChild(o),n.appendChild(document.createElement("br"));const i=document.createElement("input");i.type="email",i.placeholder=s.settings.emailPlaceholder||"Email",n.appendChild(i),n.appendChild(document.createElement("br"));const l=document.createElement("textarea");l.placeholder=s.settings.messagePlaceholder||"Message",n.appendChild(l),n.appendChild(document.createElement("br"));const r=document.createElement("button");return r.type="submit",r.textContent=s.settings.buttonText||"Send",r.style.color=s.settings.buttonColor||"#fff",r.style.backgroundColor=s.settings.buttonBackgroundColor||"#007bff",r.style.borderColor=s.settings.buttonBorderColor||"#007bff",n.appendChild(r),t.appendChild(n),t}}]},T={name:"Quote Block",blocks:[{type:"quote",settingsSchema:[{key:"text",label:"Text",type:"text"},...c.BaseStyleSchema],renderer:s=>{const t=document.createElement("blockquote");return c.applyBaseStyles(t,s.settings),t.textContent=s.settings.text||"Quote...",t.style.borderLeft="4px solid #000",t.style.paddingLeft="12px",t.style.opacity="0.8",t},defaultSettings:{text:"This is a quote"}}]},S=new B(document.getElementById("app"));k(L);k(v);k(T);S.load(x);S.initChooser();
